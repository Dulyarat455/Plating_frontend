<div class="dash-page">

    <!-- Vendor Summary (TOP) -->
<section class="vendor-summary">
    <div class="vendor-card vendor-zip">
      <div class="vendor-title">Vendor ZIP</div>
  
      <div class="vendor-metrics">
        <div class="metric-row">
          <div class="metric-label">Total Issue</div>
          <div class="metric-value value-blue">850</div>
        </div>
  
        <div class="metric-row">
          <div class="metric-label">Total Receive</div>
          <div class="metric-value value-blue">720</div>
        </div>
  
        <div class="metric-row">
          <div class="metric-label">Balance</div>
          <div class="metric-value value-red">130</div>
        </div>
  
        <div class="metric-row">
          <div class="metric-label">Receive Rate</div>
          <div class="metric-value value-blue">85%</div>
        </div>
      </div>
    </div>
  
    <div class="vendor-card vendor-metek">
      <div class="vendor-title">Vendor METEK</div>
  
      <div class="vendor-metrics">
        <div class="metric-row">
          <div class="metric-label">Total Issue</div>
          <div class="metric-value value-green">780</div>
        </div>
  
        <div class="metric-row">
          <div class="metric-label">Total Receive</div>
          <div class="metric-value value-green">650</div>
        </div>
  
        <div class="metric-row">
          <div class="metric-label">Balance</div>
          <div class="metric-value value-orange">130</div>
        </div>
  
        <div class="metric-row">
          <div class="metric-label">Receive Rate</div>
          <div class="metric-value value-green">83%</div>
        </div>
      </div>
    </div>
  </section>
  

    <!-- TRANSACTION HISTORY -->
    <section class="dash-card">
      <div class="issue-header">
        <h3 class="card-title">Transaction Issue (By Lot)</h3>
      </div>
    
      <div class="table-wrap tx-wrap">
        <table class="tx-table tx-lot">
          <thead>
            <tr>
              <th class="col-exp"></th>
              <th style="width: 170px;">DATE/TIME</th>
              <th style="width: 120px;">VENDOR</th>
    
              <th style="width: 220px;">LOT ISSUE NO</th>
              <th style="width: 110px;" class="text-center">BOX</th>
              <th style="width: 120px;">TOTAL QTY</th>
              <th style="width: 150px;">STATUS</th>
            </tr>
          </thead>
    
          <tbody>
            <ng-container *ngFor="let lot of issueLots">
              <!-- Lot row -->
              <tr class="lot-row">
                <td class="col-exp">
                  <button
                    class="btn-expand"
                    type="button"
                    (click)="toggleLot('issue', lot.lotIssueNo)"
                    [attr.aria-expanded]="isExpanded('issue', lot.lotIssueNo)"
                    aria-label="Expand"
                  >
                    <i
                      class="fas"
                      [ngClass]="isExpanded('issue', lot.lotIssueNo) ? 'fa-chevron-up' : 'fa-chevron-down'"
                    ></i>
                  </button>
                </td>
    
                <td>{{ lot.dateTime }}</td>
                <td>{{ lot.vendor }}</td>
    
                <td class="mono">{{ lot.lotIssueNo }}</td>
    
                <td class="text-center">
                  <span class="box-pill"><i class="fas fa-box"></i> {{ lot.boxCount }}</span>
                </td>
    
                <td class="mono">{{ lot.totalQty }}</td>
    
                <td>
                  <span class="status-pill" [ngClass]="lot.status === 'Wait' ? 'wait' : 'done'">
                    <i class="far" [ngClass]="lot.status === 'Wait' ? 'fa-clock' : 'fa-check-circle'"></i>
                    {{ lot.status }}
                  </span>
                </td>
              </tr>
    
              <!-- Expanded: Boxes inside lot -->
              <tr class="lot-detail" *ngIf="isExpanded('issue', lot.lotIssueNo)">
                <td colspan="7">
                  <div class="lot-detail-card">
                    <div class="lot-detail-head">
                      <div class="lot-detail-title">
                        <i class="fas fa-boxes"></i>
                        Box list in Lot Issue: <span class="mono">{{ lot.lotIssueNo }}</span>
                      </div>
                      <div class="lot-detail-hint">* รายการกล่องทั้งหมดใน Lot นี้</div>
                    </div>
    
                    <div class="lot-box-wrap">
                      <table class="box-table">
                        <thead>
                          <tr>
                            <th>Item No.</th>
                            <th>Item Name</th>
                            <th>WOS</th>
                            <th>DWG</th>
                            <th>DIE</th>
                            <th>LOT</th>
                            <th class="text-end">QTY</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let b of lot.boxes">
                            <td class="mono">{{ b.itemNo }}</td>
                            <td class="strong">{{ b.itemName }}</td>
                            <td class="mono">{{ b.wos }}</td>
                            <td class="mono">{{ b.dwg }}</td>
                            <td class="mono">{{ b.die }}</td>
                            <td class="mono">{{ b.lotNo }}</td>
                            <td class="text-end strong">{{ b.qty }}</td>
                          </tr>
    
                          <tr *ngIf="!lot.boxes?.length">
                            <td colspan="7" class="empty-row">No box in this lot</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </section>




    <section class="dash-card">
      <div class="receive-header">
        <h3 class="card-title">Transaction Receive (By Lot)</h3>
      </div>
    
      <div class="table-wrap tx-wrap">
        <table class="tx-table tx-lot tx-lot-receive">
          <thead>
            <tr>
              <th class="col-exp"></th>
              <th style="width: 170px;">DATE/TIME</th>
              <th style="width: 120px;">VENDOR</th>
    
              <th style="width: 220px;">LOT RECEIVE NO</th>
              <th style="width: 110px;" class="text-center">BOX</th>
              <th style="width: 120px;">TOTAL QTY</th>
              <th style="width: 150px;">STATUS</th>
            </tr>
          </thead>
    
          <tbody>
            <ng-container *ngFor="let lot of receiveLots">
              <!-- Lot row -->
              <tr class="lot-row">
                <td class="col-exp">
                  <button
                    class="btn-expand"
                    type="button"
                    (click)="toggleLot('receive', lot.lotReceiveNo)"
                    [attr.aria-expanded]="isExpanded('receive', lot.lotReceiveNo)"
                    aria-label="Expand"
                  >
                    <i
                      class="fas"
                      [ngClass]="isExpanded('receive', lot.lotReceiveNo) ? 'fa-chevron-up' : 'fa-chevron-down'"
                    ></i>
                  </button>
                </td>
    
                <td>{{ lot.dateTime }}</td>
                <td>{{ lot.vendor }}</td>
    
                <td class="mono">{{ lot.lotReceiveNo }}</td>
    
                <td class="text-center">
                  <span class="box-pill box-pill-green"><i class="fas fa-box"></i> {{ lot.boxCount }}</span>
                </td>
    
                <td class="mono">{{ lot.totalQty }}</td>
    
                <td>
                  <span class="status-pill" [ngClass]="lot.status === 'Wait' ? 'wait' : 'done'">
                    <i class="far" [ngClass]="lot.status === 'Wait' ? 'fa-clock' : 'fa-check-circle'"></i>
                    {{ lot.status }}
                  </span>
                </td>
              </tr>
    
              <!-- Expanded: Boxes inside lot -->
              <tr class="lot-detail" *ngIf="isExpanded('receive', lot.lotReceiveNo)">
                <td colspan="7">
                  <div class="lot-detail-card lot-detail-card-green">
                    <div class="lot-detail-head">
                      <div class="lot-detail-title">
                        <i class="fas fa-boxes"></i>
                        Box list in Lot Receive: <span class="mono">{{ lot.lotReceiveNo }}</span>
                      </div>
                      <div class="lot-detail-hint">* รายการกล่องทั้งหมดใน Lot นี้</div>
                    </div>
    
                    <div class="lot-box-wrap">
                      <table class="box-table">
                        <thead>
                          <tr>
                            <th>Item No.</th>
                            <th>Item Name</th>
                            <th>WOS</th>
                            <th>DWG</th>
                            <th>DIE</th>
                            <th>LOT</th>
                            <th class="text-end">QTY</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let b of lot.boxes">
                            <td class="mono">{{ b.itemNo }}</td>
                            <td class="strong">{{ b.itemName }}</td>
                            <td class="mono">{{ b.wos }}</td>
                            <td class="mono">{{ b.dwg }}</td>
                            <td class="mono">{{ b.die }}</td>
                            <td class="mono">{{ b.lotNo }}</td>
                            <td class="text-end strong">{{ b.qty }}</td>
                          </tr>
    
                          <tr *ngIf="!lot.boxes?.length">
                            <td colspan="7" class="empty-row">No box in this lot</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </section>
    
  <!-- (ต่อด้วย) Issue Pending + Receive Pending ของเดิม -->
  

    
  
  </div>
  